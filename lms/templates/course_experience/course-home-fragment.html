## mako

<%page expression_filter="h"/>
<%namespace name='static' file='../static_content.html'/>

<%!
import json

from django.conf import settings
from django.utils.translation import ugettext as _
from django.template.defaultfilters import escapejs
from django.urls import reverse

from django_comment_client.permissions import has_permission
from openedx.core.djangolib.js_utils import dump_js_escaped_json, js_escaped_string
from openedx.core.djangolib.markup import HTML
from openedx.features.course_experience import UNIFIED_COURSE_TAB_FLAG, SHOW_REVIEWS_TOOL_FLAG
from openedx.features.learner_analytics import ENABLE_DASHBOARD_TAB
from openedx.features.portfolio_project import INCLUDE_PORTFOLIO_UPSELL_MODAL
%>

<%block name="header_extras">
  <link rel="stylesheet" type="text/css" href="${static.url('paragon/static/paragon.min.css')}" />
</%block>

<%block name="content">
<div class="course-view page-content-container" id="course-container">

    % if ENABLE_DASHBOARD_TAB.is_enabled(course_key):
        ${static.renderReact(
          component="UpsellExperimentModal",
          id="upsell-modal",
          props={},
        )}
    % endif

    % if INCLUDE_PORTFOLIO_UPSELL_MODAL.is_enabled():
        ${static.renderReact(
            component="PortfolioExperimentUpsellModal",
            id="portfolio-experiment-upsell-modal",
            props={}
        )}
    % endif

    <header class="page-header has-secondary">
        <div class="page-header-main">
            <nav aria-label="${_('Course Outline')}" class="sr-is-focusable" tabindex="-1">
                <h2 class="hd hd-3 page-title">${course.display_name_with_default}</h2>
            </nav>
        </div>
        <div class="page-header-secondary">
            % if settings.FEATURES.get('ENABLE_COURSEWARE_SEARCH'):
                <div class="page-header-search">
                    <form class="search-form input-group" role="search" action="${reverse('openedx.course_search.course_search_results', args=[course_key])}">
                        <label class="field-label sr-only" for="search" id="search-hint">${_('Search the course')}</label>
                        <input
                                class="field-input input-text search-input form-control"
                                type="search"
                                name="query"
                                id="search"
                                placeholder="${_('Search the course')}"
                        />
                        <span class="input-group-btn">
                            <button class="btn btn-outline-primary search-button" type="submit">${_('Search')}</button>
                        </span>
                    </form>
                </div>
            % endif
            <div class="form-actions">
                % if resume_course_url:
                    <a class="btn btn-primary action-resume-course" href="${resume_course_url}">
                        % if has_visited_course:
                            <span data-action-type="resume">${_("Resume Course")}</span>
                        % else:
                            <span data-action-type="start">${_("Start Course")}</span>
                        % endif
                    </a>
                % endif
            </div>
        </div>
    </header>
    <div class="page-content">
        <div class="page-content-main">
            % if course_expiration_fragment:
                ${HTML(course_expiration_fragment.content)}
            % endif
            % if course_home_message_fragment:
                ${HTML(course_home_message_fragment.body_html())}
            % endif

            % if update_message_fragment and UNIFIED_COURSE_TAB_FLAG.is_enabled(course.id):
                <div class="section section-update-message">
                    ${HTML(update_message_fragment.body_html())}
                </div>
            % endif

            % if outline_fragment:
                ${HTML(outline_fragment.body_html())}
            % endif
        </div>
        <aside class="page-content-secondary course-sidebar">
            % if has_goal_permission:
                <div class="section section-goals ${'' if current_goal else 'hidden'}">
                    <div class="current-goal-container">
                        <label class="title title-label hd-6" for="goal">
                            <h3 class="hd-6">${_("Goal: ")}</h3>
                        </label>
                        <h3 class="title hd-6">${_("Goal: ")}</h3>
                        <div class="goal">
                            <span class="text">${goal_options[current_goal.goal_key] if current_goal else ""}</span>
                        </div>
                        <select class="edit-goal-select" id="goal">
                            % for goal, goal_text in goal_options.items():
                                <option value="${goal}" ${"selected" if current_goal and current_goal.goal_key == goal else ""}>${goal_text}</option>
                            % endfor
                        </select>
                        <span class="sr sr-update-response-msg" aria-live="polite"></span>
                        <span class="response-icon" aria-hidden="true"></span>
                        <span class="sr">${_("Edit your course goal:")}</span>
                        <button class="edit-icon">
                            <span class="sr">${_("Edit your course goal:")}</span>
                            <span class="fa fa-pencil" aria-hidden="true"></span>
                        </button>
                    </div>
                </div>
            % endif
            % if course_tools:
                <div class="section section-tools">
                    <h3 class="hd-6 section-title">${_("Course Tools")}</h3>
                    <ul class="list-unstyled">
                        % for course_tool in course_tools:
                            <li class="course-tool">
                                <a class="course-tool-link" data-analytics-id="${course_tool.analytics_id()}" href="${course_tool.url(course_key)}">
                                    <span class="icon ${course_tool.icon_classes()}" aria-hidden="true"></span>
                                    ${course_tool.title()}
                                </a>
                            </li>
                        % endfor
                    </ul>
                </div>
            % endif
            % if upgrade_url and upgrade_price:
                <div class="section section-upgrade course-home-sidebar-upgrade">
                    <h3 class="hd hd-6">${_("Pursue a verified certificate")}</h3>
                        <img src="https://courses.edx.org/static/images/edx-verified-mini-cert.png" alt="">
                        <div class="upgrade-container">
                            <p>
                                <a class="btn-brand btn-upgrade"
                                   href="${upgrade_url}"
                                   data-creative="sidebarupsell"
                                   data-position="sidebar-message">
                                   ${_("Upgrade ({price})").format(price=upgrade_price)}
                                </a>
                            </p>
                    <p><button class="btn-link btn-small promo-learn-more">${_('Learn More')}</button></p>
                        </div>
                </div>
            % endif
            % if dates_fragment:
                <div class="section section-dates">
                    ${HTML(dates_fragment.body_html())}
                </div>
            % endif
            % if handouts_html:
                <div class="section section-handouts">
                    <h3 class="hd-6 section-title">${_("Course Handouts")}</h3>
                    ${HTML(handouts_html)}
                </div>
            % endif
        </aside>
    </div>
    % if course_sock_fragment:
        ${HTML(course_sock_fragment.body_html())}
    % endif
</div>
</%block>

<%static:webpack entry="CourseHome">
    new CourseHome({
        courseRunKey: "${course_key | n, js_escaped_string}",
        resumeCourseLink: ".action-resume-course",
        courseToolLink: ".course-tool-link",
        goalApiUrl: "${goal_api_url | n, js_escaped_string}",
        username: "${username | n, js_escaped_string}",
        courseId: "${course.id | n, js_escaped_string}",
    });
</%static:webpack>

<%static:webpack entry="Enrollment">
    new CourseEnrollment('.enroll-btn', '${course_key | n, js_escaped_string}');
</%static:webpack>
<style>
body {
  font-family: "Trebuchet MS","Open Sans",Verdana,Geneva,sans-serif,sans-serif;
}

/* header */
h2.course-header {
  color: #707172;
  line-height: 40px;
  margin: 0 15px;
}
.header-global.slim {
  border-bottom: 1px solid #00acd7;
  min-height:unset;
  padding: 5px 0 10px 0;
}
.header-global.slim h2{
   margin-bottom: 0;
   text-transform: none;
   text-shadow: 0 1px 0 #fff;
   white-space: nowrap;
   text-overflow: ellipsis;
   overflow: hidden;
}
.header-global.slim .wrapper-header {
  height:auto;
  padding:0 15px;
}
.header-global.slim .wrapper-header .logo img {
  height:41px;
}
.wrapper-course-material .course-tabs li {
  margin-right:4px;
}
.header-global.slim .wrapper-header .wrapper-user-menu {
  background-color: #e9e6df;
  display: flex;
  align-items: center;
  margin-top: 7px!important;
}
.dropdown-menu-container {
  height:44px;
}
.dropdown-menu-container .menu-title {
  color: #707172;
  display: flex;
  align-items: center;
  margin-right: 5px;
  font-family: "Trebuchet MS","Open Sans","Verdana","Geneva",sans-serif;
}
.dropdown-menu-container .menu-title:hover {
  text-decoration: none;
  background: #fbfbf9;
}
.list-divided .item {
  border-bottom:0;
}
.dropdown-menu-container .dropdown-menu .dropdown-item a {
  padding: 3px 5px;
  font-size: 16px;
  color: #00acd7;
}
.dropdown-menu-container .dropdown-menu .dropdown-item a:hover,
.dropdown-menu-container .dropdown-menu .dropdown-item a:active,
.dropdown-menu-container .dropdown-menu .dropdown-item a:focus {
  text-decoration: none;
  color: #707172;
}
.dropdown-menu-container .menu-image {
  max-height:44px;
  max-width:unset!important;
  margin:0;
}
.dropdown-menu-container .dropdown-menu {
  border: 1px solid #c8c8c8;
  width: auto;
  min-width: 140px;
}

/* right floating buttons */
.contact-us-tab {
  position: fixed;
  z-index: 99;
  top: 500px;
  right: 5px;
  opacity: .85;
  transform: rotate(90deg);
  transform-origin: top right;
}
.contact-us-tab a {
  padding: 5px;
  background-color: #00acd7;
}
.contact-us-tab a:link, .contact-us-tab a:visited {
  color: #fbfbf9;
}
.contact-us-tab a:hover {
  color: #00acd7;
  background-color: #fbfbf9;
}
.dropdown-menu-container .menu-image {
  max-height:44px;
  margin-right:6px;
}
.header-global.slim .wrapper-header .course-header {
  margin-top: 10px;
}
.header-global.slim .wrapper-header .list-inline.authenticated {
  display:none;
}

/* footer */

footer#footer-edx-v3.pok-footer nav ol {
  list-style-type: none;
  margin-left: 0;
}

#polimi-header, #polimi-footer {
  background: #00acd7;
  box-shadow: inset 0 -4px 8px -2px rgba(0,0,0,0.2);
  text-align: center;
  padding: 0 0 1px;
}

#polimi-header img, #polimi-footer img {
  vertical-align: unset;
}

/* start manually copying and parsing poli_footer sass >___< */

footer#footer-edx-v3.pok-footer {
  padding:0;
  background: white;
}

footer#footer-edx-v3.pok-footer p {
  line-height: 1.3;
  color: #707172; /* only needed on course page */
}

footer#footer-edx-v3.pok-footer p, footer#footer-edx-v3.pok-footer li {
  font-size: .9em;
  margin-bottom: 15px;
}

footer#footer-edx-v3.pok-footer nav a {
  color: #707172;
}

footer#footer-edx-v3.pok-footer nav a.standard-link {
  color: #00acd7;
}

footer#footer-edx-v3.pok-footer .footer-content-wrapper .site-nav li a {
  text-transform: uppercase;
  font-family: "Yanone Kaffeesatz";
  font-size:24px;
}

footer#footer-edx-v3.pok-footer .footer-content-wrapper .site-nav li a:hover {
  text-decoration:none;
  color: #00acd7;
}

footer#footer-edx-v3.pok-footer .footer-content-wrapper > div {
  padding: 35px 15px 20px;
  box-sizing: border-box;
}

footer#footer-edx-v3.pok-footer .resources, footer#footer-edx-v3.pok-footer .references {
  border-top: 1px solid #e6e6e6;
}

footer#footer-edx-v3.pok-footer .social {
  padding-bottom:30px;
}

footer#footer-edx-v3.pok-footer .social span.fa {
  font-family: 'FontAwesome';
}

footer#footer-edx-v3.pok-footer .social a {
  display: inline-block;
  color: white;
  background-color: #00acd7;
  border-radius: 50%;
  height: 44px;
  width: 44px;
  text-align: center;
  font-size: 24px;
  line-height: 1.9;
  margin-right: 6px;
}

footer#footer-edx-v3.pok-footer .social a:last-child {
  margin-right: 0;
}

footer#footer-edx-v3.pok-footer .social a:hover {
  transform: scale(1.2);
}

footer#footer-edx-v3.pok-footer .openedx {
  padding-bottom:30px;
}

footer#footer-edx-v3.pok-footer .eco-references, footer#footer-edx-v3.pok-footer .badge {
  display: flex;
  align-items: center;
}

footer#footer-edx-v3.pok-footer img {
  margin-bottom: 15px;
}

footer#footer-edx-v3.pok-footer .eco-references img, footer#footer-edx-v3.pok-footer .reimagine-award img {
  margin-right:15px;
  max-width: unset;
}

/* copying and parsing footer grid settings */

footer#footer-edx-v3.pok-footer .footer-content-wrapper {
  display: grid;
  grid-template-columns: 1fr;
  grid-template-areas: "nav"
                       "social"
                       "loghi";
}

footer#footer-edx-v3.pok-footer .footer-nav {
  grid-area: nav;
}

footer#footer-edx-v3.pok-footer .resources {
  grid-area: social;
}

footer#footer-edx-v3.pok-footer .references {
  grid-area: loghi;
}

@media (min-width:769px) {
  footer#footer-edx-v3.pok-footer .footer-content-wrapper {
    grid-template-columns: 1fr 1fr 1fr;
    grid-template-areas: "nav social ."
                         "loghi loghi loghi";
  }

  footer#footer-edx-v3.pok-footer .footer-content-wrapper > div {
    display: table-cell;
    vertical-align: top;
  }

  footer#footer-edx-v3.pok-footer .resources {
    border-top:0;
  }
}

@media (min-width:980px) {
  footer#footer-edx-v3.pok-footer .footer-content-wrapper {
    grid-template-columns: 1fr 1fr 1fr 1fr;
    grid-template-areas: "nav social . loghi";
  }

  footer#footer-edx-v3.pok-footer .references {
    border-top:0;
  }
}

@media (min-width:769px) and (max-width: 979px){
  footer#footer-edx-v3.pok-footer div.references {
    display: table;
    width: 100%;
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    grid-column-gap: 30px;
  }

  footer#footer-edx-v3.pok-footer .openedx {
    padding-bottom:0;
  }
}


/* RESPONSIVE RULES */
.header-global .wrapper-user-menu {
    height: 40px;
}

.header-global .wrapper-user-menu .menu-title .menu-image{
    margin: 0;
    margin-right: 15px;
}

.header-global .wrapper-user-menu .user-menu button{
    margin-top: 0;
    color: #707172;
}

.tabs .tab a, .tabs .tab a:visited{
    color:#5e5e5e;
}

header.header-global.slim{
    border-bottom: none;
}
header.header-global.slim h2{
    width: 50%;
}


@media only screen and (max-width: 1220px){
  body.view-in-course .wrapper-course-material{
    max-width: 1300px;
    padding: 0 2em;
  }
  .polimi-name img {
    max-width: 100%;
    height: auto;
  }
}


@media only screen and (max-width: 1220px){
  body.view-in-course .wrapper-course-material{
    max-width: 1300px;
    padding: 0 2em;
  }
  .polimi-name img {
    max-width: 100%;
    height: auto;
  }
}

@media only screen and (max-width: 1024px){
  .header-global.slim .wrapper-header .wrapper-user-menu{
    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAADNElEQVRoge2Z226jMBCG9/2fsK1UqfEZYxubQBIL7H8vVkRptklKcGh31ZF+CXEDn2bGc/Av/Cf266t/oJT9gHw3+wH5bvYDcs1SStjtdnDOQWsNpRS01rDWou97jONY/JtFQcZxRNM0oJSCcw6tNYwxcM7BGIO6riGEAKUU1loMw1Ds28VADocDGGOQUsJ7j7ZtLyqEAKUUKKXY7XZFvl8EZL/f4+npCdbaqwDnapoGhBB0Xbf4HxaDxBhBKYVzbhbEKczz8/NizywCSSmBcz7bE+dyzoExtugQWATSti0454sgJkkp0TTN+iA5Z3DO0TRNERDvPSilSCmtCxJjBGOsCMQkzjn2+/26INvtFkqpoiBVVcF7vy6I9x5VVRUFmar/qiBT+1ESZKr+q4JM1bm0R5xz64J0XQcpZVEQpdT6OTIMAwghRUEYYzgcDuuCAADn/O7W5FxTHck5rw8SQoAQolhY3Zsfi0FSSqCULq7ukzeWzCeLu98ptkMId4MIIRb1WUVAcs5QSt1dHKep8d4eqxgI8GfEFULM7r201mCMFRl5i426OWdsNhsIIW6GWQgBhBC8vr4Wm9uLLh9yzschaWoAz5O6qiowxmCMufuo/cgesg6KMcI5B0opCCHgnIMQAkopjDF3F71r9tAFXc4ZKSXEGJFSKuqBcysOEmNECOGYyJNXNpvNcd9ljEHbtt9vr5VSQggBnHMwxqCUgjEG3vt3ie+9R9M0qOsaUkoQQiClRN/3i721GGS73R4Xc3P7rhACrLVgjEEIgRjj+iA5ZxhjwBgr0jgaY0ApRdu264EMwwAhBKSUi1qTc017Y63140HGccTLy0vxMfc03KY8m5M3s0CGYTgWu0dAnDeSxpjyICklCCEe5olLnvns6PspkJzz8cJmDYhTGErpp5Z2nwLpum7xzHGvjDEQQtzMl5sg4zguujYolS+3QuwmiLV29ZA61zQKX7t2uAoyrXxuXaWtoVvXDldBrLWrHLVzvHJpJL4IMm1IviLBr3mlbT9uYS6ChBDw9vaGuq6htYbW+uLzWqqqCpTSeSAxRlhr38k599e70/fOuYer7/t5IP+a/QaUJ0Nq3LLBawAAAABJRU5ErkJggg==");
    background-size: 40px;
    background-repeat: no-repeat;
    padding-left: 40px;
  }
  .header-global.slim .wrapper-header .wrapper-user-menu .menu-title{
    clip: rect(1px 1px 1px 1px);
    clip: rect(1px, 1px, 1px, 1px);
    position: absolute;
    margin: -1px;
    height: 1px;
    width: 1px;
    border: 0;
    padding: 0;
    overflow: hidden;
    word-wrap: normal;
  }
}

@media only screen and (max-width: 768px){
  html .header-global.slim .wrapper-header h2{
    font-size: 0.9em;
    max-width: 50%;
    clear: none;
  }
}

@media only screen and (max-width: 480px){
  html .header-global.slim .wrapper-header h2{
    line-height: 32px;
    margin: 0;
  }
  header.header-global.slim{
    min-height: 65px;
  }
  .header-global.slim .wrapper-header .logo img{
    margin-top: 0;
  }
  .header-global.slim .wrapper-header .wrapper-user-menu{
    background-size: 30px;
    background-repeat: no-repeat;
    padding-left: 30px;
    height: 30px;
  }
  .header-global.slim .wrapper-header .wrapper-user-menu button{
    margin-top: -2px;
    width: 25px;
    height: 25px;
  }
  html .header-global.slim .wrapper-header h1.logo img,
  html .header-global.header-global h1.logo img {
    height: 35px;
  }
}


</style>